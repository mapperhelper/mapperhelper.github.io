<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.21" />
    <meta name="description" content="">


    

    
    <title>7. 3.3.0 版本新增内容使用文档</title>
    <link href="https://mapperhelper.github.io/css/nucleus.css" rel="stylesheet">
    <link href="https://mapperhelper.github.io/css/font-awesome.min.css" rel="stylesheet">
    <link href="https://mapperhelper.github.io/css/hybrid.css" rel="stylesheet">
    <link href="https://mapperhelper.github.io/css/featherlight.min.css" rel="stylesheet">
    <link href="https://mapperhelper.github.io/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="https://mapperhelper.github.io/css/horsey.css" rel="stylesheet">
    <link href="https://mapperhelper.github.io/css/theme.css" rel="stylesheet">
    <link href="https://mapperhelper.github.io/css/hugo-theme.css" rel="stylesheet">
    <script src="https://mapperhelper.github.io/js/jquery-2.x.min.js"></script>
    <style type="text/css">:root #header + #content > #left > #rlblock_left
    {display:none !important;}</style>
    

    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?aa614f061a0b498c030579fe57423496";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
  </head>
  <body class="" data-url="/docs/7.use330/">
    
    <nav id="sidebar">
  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://getgrav.org" style="font-weight:bold;">
MyBatis 通用 Mapper
</a>

    </div>
    
</div>


  <div class="highlightable">
    <ul class="topics">
      
        
        
          
          
            
          
        
          
          
            
          
        
          
          
            
          
        
          
          
            
          
        
        
        
          
        
          
        
          
        
          
        
      
      
      
      

      
      
      
        
          
        
      
      
      

      <li class="dd-item  parent" data-nav-id="/docs/">
        <a href="/docs/">
          <span>
            
              <b>1. </b>
            
             MyBatis 通用 Mapper
            
           </span>
        </a>
        
        <ul>
          
            <li class="dd-item " data-nav-id="/docs/1.integration/">
              <a href="/docs/1.integration/">
                <span>1. 集成通用 Mapper     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs/2.use/">
              <a href="/docs/2.use/">
                <span>2. 使用通用 Mapper     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs/3.usembg/">
              <a href="/docs/3.usembg/">
                <span>3. MyBatis Generator 插件     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs/3-2.mapper-uuid/">
              <a href="/docs/3-2.mapper-uuid/">
                <span>4. UUID 简单示例     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs/5.professional/">
              <a href="/docs/5.professional/">
                <span>5. 高级用法     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs/6.mymapper/">
              <a href="/docs/6.mymapper/">
                <span>6. 开发自己的通用接口方法     </i></span>
              </a>
            </li>
          
            <li class="dd-item active" data-nav-id="/docs/7.use330/">
              <a href="/docs/7.use330/">
                <span>7. 3.3.0 版本新增内容使用文档     </i></span>
              </a>
            </li>
          
            <li class="dd-item " data-nav-id="/docs/8.updateto3/">
              <a href="/docs/8.updateto3/">
                <span>8. Mapper2 升级 3 注意事项     </i></span>
              </a>
            </li>
          
        </ul>
        
      </li>
      
      
      

      
      
      
        
          
        
      
      
      

      <li class="dd-item  " data-nav-id="/all/">
        <a href="/all/">
          <span>
            
              <b>2. </b>
            
             Mapper 接口大全
            
           </span>
        </a>
        
      </li>
      
      
      

      
      
      
        
          
        
      
      
      

      <li class="dd-item  " data-nav-id="/faq/">
        <a href="/faq/">
          <span>
            
              <b>2. </b>
            
             Mapper3常见问题和用法
            
           </span>
        </a>
        
      </li>
      
      
      

      
      
      
        
          
        
      
      
      

      <li class="dd-item  " data-nav-id="/changelog/">
        <a href="/changelog/">
          <span>
            
              <b>3. </b>
            
             更新日志
            
           </span>
        </a>
        
      </li>
      
      
    </ul>
    <hr>
     
    <section id="footer">
      <p>
  <a href="https://github.com/abel533/Mapper">view on GitHub</a>
</p>
<br/>
<p>
  <a href="http://git.oschina.net/free/Mapper">view on GitOsc</a>
</p>

    </section>
  </div>
</nav>

        <section id="body">
        <div id="overlay"></div>

        <div class="padding highlightable sticky-parent">

            <div class="sticky-spacer">
              <div id="top-bar">
              
              <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                  <span id="sidebar-toggle-span">
                      <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                        <i class="fa fa-bars"></i>
                      </a>
                  </span>
                
                
                  
                  
                  
                    
                    
                <a href="/docs/" itemprop="url"><span itemprop="title">MyBatis 通用 Mapper</span></a> <i class="fa fa-angle-right"></i>
                    
                  
                
                <span itemprop="title"> 7. 3.3.0 版本新增内容使用文档</span>
              </div>
              
            </div>

            </div>
            
              <div id="body-inner">
                
                <h1>7. 3.3.0 版本新增内容使用文档</h1>
                



<h3 id="增加对动态表名的支持">增加对动态表名的支持</h3>

<h4 id="新增-idynamictablename-接口">新增<code>IDynamicTableName</code>接口：</h4>

<pre><code class="language-java">/**
 * 实现动态表名时，实体类实现该接口
 *
 * @author liuzh
 * @since 2015-10-28 22:20
 */
public interface IDynamicTableName {

    /**
     * 获取动态表名 - 这个方法是关键，只要有返回值，不是null和''，就会用返回值作为表名
     *
     * @return
     */
    String getDynamicTableName();
}
</code></pre>

<h4 id="一个动态表名的例子">一个动态表名的例子</h4>

<h5 id="首先继承-idynamictablename-接口">首先继承 <code>IDynamicTableName</code> 接口：</h5>

<pre><code class="language-java">public class Country implements IDynamicTableName {

    @Id
    @OrderBy(&quot;desc&quot;)
    private Integer id;

    @Column
    private String countryname;
    private String countrycode;

    @Transient//非表字段，字段名称无所谓
    private String dynamicTableName123;

    //省略getter和setter

    @Override//当该方法返回值不为空时，就会使用返回值作为表名
    public String getDynamicTableName() {
        return dynamicTableName123;
    }

    public void setDynamicTableName(String dynamicTableName) {
        this.dynamicTableName123 = dynamicTableName;
    }
}
</code></pre>

<h5 id="测试代码">测试代码：</h5>

<pre><code class="language-java">CountryMapper mapper = sqlSession.getMapper(CountryMapper.class);
Country country = new Country();
country.setDynamicTableName(&quot;country_123&quot;);
List&lt;country&gt; countryList = mapper.select(country);
</code></pre>

<h5 id="输出sql">输出SQL：</h5>

<p><code>SELECT id,countryname,countrycode FROM country_123 ORDER BY id</code></p>

<h3 id="example-增加了4个方法"><code>Example</code>增加了4个方法</h3>

<pre><code class="language-java">/**
 * 手写条件
 *
 * @param condition 例如 &quot;length(countryname)&lt;5&quot;
 * @return
 */
public Criteria andCondition(String condition) {
    addCriterion(condition);
    return (Criteria) this;
}

/**
 * 手写左边条件，右边用value值
 *
 * @param condition 例如 &quot;length(countryname)=&quot;
 * @param value 例如 5
 * @return
 */
public Criteria andCondition(String condition, Object value) {
    criteria.add(new Criterion(condition, value));
    return (Criteria) this;
}

/**
 * 手写左边条件，右边用value值
 *
 * @param condition 例如 &quot;length(countryname)=&quot;
 * @param value 例如 5
 * @param typeHandler 类型处理
 * @return
 */
public Criteria andCondition(String condition, Object value, String typeHandler) {
    criteria.add(new Criterion(condition, value, typeHandler));
    return (Criteria) this;
}

/**
 * 手写左边条件，右边用value值
 *
 * @param condition 例如 &quot;length(countryname)=&quot;
 * @param value 例如 5
 * @param typeHandler 类型处理
 * @return
 */
public Criteria andCondition(String condition, Object value, Class&lt;? extends TypeHandler&gt; typeHandler) {
    criteria.add(new Criterion(condition, value, typeHandler.getCanonicalName()));
    return (Criteria) this;
}
</code></pre>

<h4 id="example-新方法用法举例"><code>Example</code>新方法用法举例</h4>

<pre><code class="language-java">Example example = new Example(Country.class);
example.createCriteria()
        .andCondition(&quot;countryname like 'C%' and id &lt; 100&quot;)
        .andCondition(&quot;length(countryname) = &quot;, 5)
        .andCondition(&quot;countrycode =&quot;, &quot;CN&quot;, StringTypeHandler.class);
List&lt;Country&gt; countries = mapper.selectByExample(example);
</code></pre>

<h4 id="输出sql-1">输出SQL</h4>

<pre><code class="language-sql">SELECT id,countryname,countrycode
FROM Country
WHERE (
countryname like 'C%'
and id &lt; 100
and length(countryname) = ?
and countrycode = ?
)
ORDER BY id desc
</code></pre>

<h3 id="generatedvalue-strategy-generationtype-identity-的一种重要用法说明"><code>@GeneratedValue(strategy = GenerationType.IDENTITY)</code>的一种重要用法说明：</h3>

<p><code>IDENTITY</code>除了<a href="http://git.oschina.net/free/Mapper/blob/master/wiki/mapper3/3.Use.md#2-&lt;code&gt;-generatedvalue-strategy-=-generationtype-identity-&lt;-code">集成文档</a>中的这些选项外，还可以是任意可以执行的SQL，例如MySql的<code>select uuid()</code>,SqlServer的<code>select newid()</code>等等，这种情况下需要保证主键的类型和SQL的返回值一致。</p>

<p>利用这一个特点，我们就可以使用可以回写的UUID值，如果想获得更特殊的主键值，可以自己写函数调用。</p>


      
      
      </div>
    </div>

    

    <div id="navigation">
        
        
        
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="https://mapperhelper.github.io/js/clipboard.min.js"></script>
    <script src="https://mapperhelper.github.io/js/perfect-scrollbar.min.js"></script>
    <script src="https://mapperhelper.github.io/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="https://mapperhelper.github.io/js/jquery.sticky-kit.min.js"></script>
    <script src="https://mapperhelper.github.io/js/featherlight.min.js"></script>
    <script src="https://mapperhelper.github.io/js/html5shiv-printshiv.min.js"></script>
    <script src="https://mapperhelper.github.io/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="https://mapperhelper.github.io/js/modernizr.custom.71422.js"></script>
    <script src="https://mapperhelper.github.io/js/learn.js"></script>
    <script src="https://mapperhelper.github.io/js/hugo-learn.js"></script>
    

  </body>
</html>

